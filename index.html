<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Deformable Neural Radiance Fields creates free-viewpoint portraits (nerfies) from casually captured videos.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Probabilistic Interactive 3D Segmentation with Hierarchical Neural Processes</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="#"><strong>NPISeg3D</strong></a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#abstract">Abstract</a>
        <a class="navbar-item" href="#method">Method</a>
        <a class="navbar-item" href="#results">Results</a>
        <a class="navbar-item" href="#bibtex">BibTeX</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Paper</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://arxiv.org/abs/2403.12345" target="_blank">
              <span class="icon"><i class="ai ai-arxiv"></i></span>
              <span>arXiv</span>
            </a>
            <a class="navbar-item" href="./static/poster.pdf" target="_blank">
              <span class="icon"><i class="fas fa-file-pdf"></i></span>
              <span>Poster</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<section class="hero is-fullheight" style="min-height: 45vh;">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title" data-aos="fade-up" style="margin-bottom: 1.5rem;">Probabilistic Interactive 3D Segmentation with Hierarchical Neural Processes</h1>
          <div class="is-size-5 publication-authors" data-aos="fade-up" data-aos-delay="100" style="margin-bottom: 1.5rem;">
            <span class="author-block"><a href="https://jliu4ai.github.io">Jie Liu</a><sup>1</sup>,</span>
            <span class="author-block"><a href="https://panzhous.github.io/">Pan Zhou</a><sup>2</sup>,</span>
            <span class="author-block"><a href="https://zzzx1224.github.io/">Zehao Xiao</a><sup>1</sup>,</span>
            <span class="author-block"><a href="https://autumn9999.github.io/">Jiayi Shen</a><sup>1</sup>,</span>
            <span class="author-block"><a href="https://ywzcode.github.io//">Wenzhe Yin</a><sup>1</sup>,</span>
            <span class="author-block"><a href="https://www.nki.nl/research/research-groups/jan-jakob-sonke/">Jan-Jakob Sonke</a><sup>3</sup>,</span>
            <span class="author-block"><a href="https://www.egavves.com/">Efstratios Gavves</a><sup>1</sup></span>
          </div>
          <div class="is-size-5 publication-authors" style="margin-bottom: 2rem;">
            <span class="author-block"><sup>1</sup>University of Amsterdam</span>
            <span class="author-block"><sup>2</sup>Singapore Management University</span>
            <span class="author-block"><sup>3</sup>Netherlands Cancer Institute</span>
          </div>

          <div class="publication-links" data-aos="fade-up" data-aos-delay="200" style="margin-bottom: 2rem;">
            <a href="xxx" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><i class="fas fa-file-pdf"></i></span>
              <span>Paper</span>
            </a>
            <a href="https://arxiv.org/abs/2403.12345" class="external-link button is-normal is-rounded is-dark" target="_blank">
              <span class="icon"><i class="ai ai-arxiv"></i></span>
              <span>arXiv</span>
            </a>
            <a href="./static/poster.pdf" class="external-link button is-normal is-rounded is-dark" target="_blank">
              <span class="icon"><i class="fas fa-file-pdf"></i></span>
              <span>Poster</span>
            </a>
            <a href="xxx" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><i class="fab fa-youtube"></i></span>
              <span>Video</span>
            </a>
            <a href="xxx" class="external-link button is-normal is-rounded is-dark">
              <span class="icon"><i class="fab fa-github"></i></span>
              <span>Code</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser" style="padding: 0.8rem 0;">
  <div class="container is-max-desktop">
    <div class="hero-body" style="padding: 0;">
      <img src="./static/images/intro.jpg" class="interpolation-image" alt="Intro image" style="width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);"/>
    </div>
    <h2 class="content has-text-justified" style="margin-top: 1.2rem; font-size: 1.1rem; line-height: 1.5;">
      In this work, we propose <strong>Click Prompt learning with Optimal Transport (CPlot)</strong> for interactive segmentation. With the key component <strong>Click Prompt Optimal Transport (CPOT)</strong>, our model captures diverse user intentions, leading to more accurate mask prediction.
    </h2>
  </div>
</section>

<section class="section" id="abstract" style="padding: 0.8rem 0;">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column" style="max-width: 900px;">
        <div class="abstract-section" data-aos="fade-up">
          <h2 class="title is-3 has-text-centered" style="margin-bottom: 1.2rem; color: #2c3e50; font-weight: 500;">Abstract</h2>
          <div class="custom-content" style="background-color: #ffffff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
            <p style="font-size: 1rem; line-height: 1.5; color: #34495e; text-align: justify;">
              Interactive 3D segmentation has emerged as a promising solution for generating accurate object masks in complex 3D scenes by incorporating user-provided clicks. However, two critical challenges remain underexplored: (1) effectively <strong>generalizing from sparse user clicks</strong> to produce accurate segmentations and (2) <strong>quantifying predictive uncertainty</strong> to help users identify unreliable regions. 
            </p>
            <p style="font-size: 1rem; line-height: 1.5; color: #34495e; margin-top: 1rem; text-align: justify;">
              In this work, we propose <strong>NPISeg3D, a novel probabilistic framework that builds upon Neural Processes (NPs)</strong> to address these challenges.
              Specifically, NPISeg3D introduces a hierarchical latent variable structure with scene-specific and object-specific latent variables to enhance few-shot generalization by capturing both global context and object-specific characteristics. Additionally, we design a probabilistic prototype modulator that adaptively modulates click prototypes with object-specific latent variables, improving the model's ability to capture object-aware context and quantify predictive uncertainty. 
            </p>
            <p style="font-size: 1rem; line-height: 1.5; color: #34495e; margin-top: 1rem; text-align: justify;">
              Experiments on four 3D point cloud datasets demonstrate that NPISeg3D achieves superior segmentation performance with fewer clicks while providing reliable uncertainty estimations.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="method" style="padding: 0.8rem 0;">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column" style="max-width: 900px;">
        <div class="method-section" data-aos="fade-up">
          <h2 class="title is-3 has-text-centered" style="margin-bottom: 1.2rem; color: #2c3e50; font-weight: 500;">Method</h2>
          <div class="content has-text-centered" style="margin-bottom: 1.2rem;">
            <img src="./static/images/method.jpg" class="interpolation-image" alt="Method overview" style="max-width: 100%; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
          </div>
          <div class="custom-content" style="background-color: #ffffff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
            <p style="font-size: 1rem; line-height: 1.5; color: #34495e; text-align: justify;">
              <strong>Framework of NPISeg3D.</strong> We formulate interactive 3D segmentation as a probabilistic modeling problem with neural processes. Given a 3D scene \(S\) and a user click set \(\mathcal{C}\), a point encoder encodes them into click prototypes \(\mathbf{X}_C\) (context data) and scene features \(\mathbf{X}_T\) (target data). Then, we introduce two hierarchical latent variables: scene-level latent variable \(\mathbf{z}_s\) and object-level latent variable \(\mathbf{z}_o\), to enable probabilistic modeling and capture contextual information across hierarchical levels. In probabilistic prototype modulator, each object-specific latent variable is utilized to generate object-specific weights \((\gamma, \beta)\), which modulate its corresponding click prototypes, thereby enhancing few-shot generalization and providing reliable uncertainty estimation. The posterior distributions of the latent variables are inferred from the target set \((\mathbf{X}_T,\mathbf{Y}_T)\), which supervise the prior during training.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="results" style="padding: 0.8rem 0;">
  <div class="container is-max-desktop has-text-centered">
    <h2 class="title is-3" style="margin-bottom: 0.8rem;">Qualitative Results</h2>
    <div class="content has-text-justified" style="margin-bottom: 0.8rem;">
      <p>
      Below we present some visualization of interactive 3D segmentation. As shown, NPISeg3D achieves <strong>strong few-shot generalization</strong>, i.e., high-quality segmentation with fewer clicks, and <strong>robust uncertainty estimation</strong> across datasets like ScanNet, S3DIS, and KITTI-360.
      </p>
    </div>

    <div class="carousel-container" style="position: relative; overflow: hidden; width: 100%; max-width: 800px; margin: 0.8rem auto; height: 380px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
      <div class="carousel-track" style="display: flex; transition: transform 0.5s ease-in-out; height: 100%;">
        <!-- Each slide -->
        <div class="carousel-slide" style="flex: 0 0 100%; display: flex; justify-content: center; align-items: center; height: 100%; padding: 20px;">
          <img src="./static/images/vis_results/vis_1.png" alt="Qualitative result 1"
               style="max-width: 95%; max-height: 95%; object-fit: contain; border-radius: 4px;">
        </div>
        <div class="carousel-slide" style="flex: 0 0 100%; display: flex; justify-content: center; align-items: center; height: 100%; padding: 20px;">
          <img src="./static/images/vis_results/vis_2.png" alt="Qualitative result 2"
               style="max-width: 95%; max-height: 95%; object-fit: contain; border-radius: 4px;">
        </div>
        <div class="carousel-slide" style="flex: 0 0 100%; display: flex; justify-content: center; align-items: center; height: 100%; padding: 20px;">
          <img src="./static/images/vis_results/vis_3.png" alt="Qualitative result 3"
               style="max-width: 95%; max-height: 95%; object-fit: contain; border-radius: 4px;">
        </div>
        <div class="carousel-slide" style="flex: 0 0 100%; display: flex; justify-content: center; align-items: center; height: 100%; padding: 20px;">
          <img src="./static/images/vis_results/vis_4.png" alt="Qualitative result 4"
               style="max-width: 70%; max-height: 70%; object-fit: contain; border-radius: 4px;">
        </div>
        <div class="carousel-slide" style="flex: 0 0 100%; display: flex; justify-content: center; align-items: center; height: 100%; padding: 20px;">
          <img src="./static/images/vis_results/vis_5.png" alt="Qualitative result 5"
               style="max-width: 70%; max-height: 70%; object-fit: contain; border-radius: 4px;">
        </div>
      </div>

      <!-- Navigation buttons -->
      <button class="carousel-button prev" onclick="moveSlide(-1)"
              style="position:absolute; top:50%; left:20px; transform:translateY(-50%); background: rgba(0,0,0,0.6); border: none; color: white; width: 44px; height: 44px; border-radius: 50%; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; z-index: 10;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="15,5 5,12 15,19" />
        </svg>
      </button>
      <button class="carousel-button next" onclick="moveSlide(1)"
              style="position:absolute; top:50%; right:20px; transform:translateY(-50%); background: rgba(0,0,0,0.6); border: none; color: white; width: 44px; height: 44px; border-radius: 50%; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; z-index: 10;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="9,5 19,12 9,19" />
        </svg>
      </button>

      <!-- Indicators -->
      <div class="carousel-indicators" style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 8px;">
        <span class="indicator" onclick="goToSlide(0)" style="width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease;"></span>
        <span class="indicator" onclick="goToSlide(1)" style="width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease;"></span>
        <span class="indicator" onclick="goToSlide(2)" style="width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease;"></span>
        <span class="indicator" onclick="goToSlide(3)" style="width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease;"></span>
        <span class="indicator" onclick="goToSlide(4)" style="width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.5); cursor: pointer; transition: all 0.3s ease;"></span>
      </div>
    </div>
  </div>
</section>

<section class="section" id="bibtex">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre style="background-color: #f5f5f5; padding: 1.5rem; border-radius: 4px; overflow-x: auto; max-width: 800px; margin: 0 auto;"><code>@article{jie2025probabilistic,
  author    = {Liu, Jie and Wang, Haochen and Yin, Wenzhe and Sonke, Jan-Jakob and Gavves, Efstratios},
  title     = {Click Prompt Learning with Optimal Transport for Interactive Segmentation},
  journal   = {ECCV},
  year      = {2024},
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-10" style="max-width: 1200px;">
        <div class="content">
          <p>This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
  AOS.init({
    duration: 800,
    easing: 'ease-in-out',
    once: true
  });

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
    });
  });

  // Enhanced carousel script
  let currentIndex = 0;
  const slides = document.querySelectorAll(".carousel-slide");
  const track = document.querySelector(".carousel-track");
  const indicators = document.querySelectorAll(".indicator");
  let autoPlayInterval;

  function updateSlidePosition() {
    const slideWidth = slides[0].clientWidth;
    track.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
    updateIndicators();
  }

  function updateIndicators() {
    indicators.forEach((indicator, index) => {
      if (index === currentIndex) {
        indicator.style.background = "rgba(255,255,255,1)";
        indicator.style.transform = "scale(1.2)";
      } else {
        indicator.style.background = "rgba(255,255,255,0.5)";
        indicator.style.transform = "scale(1)";
      }
    });
  }

  function moveSlide(direction) {
    const oldIndex = currentIndex;
    if (direction === 1) {
      currentIndex = (currentIndex + 1) % slides.length;
    } else {
      currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    }

    // If we're going from last to first or first to last, disable transition temporarily
    if ((oldIndex === slides.length - 1 && currentIndex === 0) || 
        (oldIndex === 0 && currentIndex === slides.length - 1)) {
      track.style.transition = 'none';
      updateSlidePosition();
      // Force a reflow
      track.offsetHeight;
      track.style.transition = 'transform 0.5s ease-in-out';
    }
    
    updateSlidePosition();
    resetAutoPlay();
  }

  function goToSlide(index) {
    currentIndex = index;
    updateSlidePosition();
    resetAutoPlay();
  }

  function resetAutoPlay() {
    clearInterval(autoPlayInterval);
    autoPlayInterval = setInterval(() => {
      moveSlide(1);
    }, 5000);
  }

  // Add hover effects to buttons
  document.querySelectorAll('.carousel-button').forEach(button => {
    button.addEventListener('mouseenter', () => {
      button.style.background = 'rgba(0,0,0,0.8)';
      button.style.transform = `translateY(-50%) scale(1.1)`;
      button.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
    });
    button.addEventListener('mouseleave', () => {
      button.style.background = 'rgba(0,0,0,0.6)';
      button.style.transform = 'translateY(-50%) scale(1)';
      button.style.boxShadow = 'none';
    });
  });

  // Initialize carousel
  updateIndicators();
  resetAutoPlay();

  window.addEventListener('resize', updateSlidePosition);
</script>

<style>
  .custom-content {
    background-color: #ffffff;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  }
</style>

</body>
</html>
